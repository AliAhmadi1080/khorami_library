{% extends "adminbase.html" %} {% block title %}جستجوی کتاب{% endblock title %}
{% block heading %}جستجوی کتاب{% endblock heading %} 
{% block search_books.html-style %} active-nav-link opacity-100 {% endblock search_books.html-style %} 
{% block maincontent %}
<div class="bg-white shadow rounded-lg p-6">
  <form method="GET" action="{% url 'search_books' %}">
    <div class="flex flex-col md:flex-row justify-around items-center gap-4">
      <div>
        <label for="book_name" class="block text-gray-700 font-medium mb-2"
          >نام کتاب</label
        >
        <input
          type="text"
          id="book_name"
          name="name"
          placeholder="نام کتاب را وارد کنید"
          class="w-full px-4 py-2 border rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
      </div>

      <div>
        <label for="book_code" class="block text-gray-700 font-medium mb-2"
          >کد کتاب</label
        >
        <input
          type="text"
          id="book_code"
          name="code"
          placeholder="کد کتاب را وارد کنید"
          class="w-full px-4 py-2 border rounded-lg text-gray-700 focus:outline-none focus:ring-2 focus:ring-blue-500"
        />
      </div>
      <div>
        <label for="is_return" class="block text-gray-700 font-medium mb-2"
          >آیا بازگشته؟</label
        >
        <input
          type="checkbox"
          id="is_return"
          name="is_return"
          class="w-6 h-6 text-blue-500 bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2 focus:outline-none transition duration-150"
        />
      </div>

      <div class="flex items-end">
        <button
          type="submit"
          class="w-full bg-blue-500 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50"
        >
          جستجو
        </button>
      </div>
    </div>
  </form>
</div>

<div class="mt-8">
  {% if results %}
  <h2 class="text-2xl font-semibold text-gray-800 mb-4">نتایج جستجو:</h2>
  <div class="py-2 -my-2 overflow-x-auto sm:-mx-6 sm:px-6 lg:-mx-8 lg:px-8">
      <br />
  <div
    class="inline-block min-w-full overflow-hidden align-middle border-b border-gray-200 shadow sm:rounded-lg"
  >
    <table class="min-w-full">
      <thead>
        <tr>
          <th
            class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-right text-gray-500 uppercase border-b border-gray-200 bg-gray-50"
          >
            #
          </th>
          <th
            class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-right text-gray-500 uppercase border-b border-gray-200 bg-gray-50"
          >
            نام شخص
          </th>
          <th
            class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-right text-gray-500 uppercase border-b border-gray-200 bg-gray-50"
          >
            اسم کتاب
          </th>
          <th
            class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-right text-gray-500 uppercase border-b border-gray-200 bg-gray-50"
          >
            کد کتاب
          </th>

          <th
            class="px-6 py-3 text-xs font-medium leading-4 tracking-wider text-right text-gray-500 uppercase border-b border-gray-200 bg-gray-50"
          ></th>
        </tr>
      </thead>

      <tbody class="bg-white">
        {% for Loan in results %}
        <tr>
          <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">
            {{forloop.counter}}
          </td>

          <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">
            {{Loan.user}}
          </td>

          <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">
            {{Loan.book.name}}
          </td>

          <td class="px-6 py-4 whitespace-no-wrap border-b border-gray-200">
            {{Loan.book.code}}
          </td>

          <td
            class="px-6 py-4 whitespace-no-wrap border-b text-green-500 border-gray-200"
          >
            {{request.request_date}}
          </td>
<td class="py-2 px-4 border-b">
          {% if not Loan.is_return %}<!--create a template for it-->
          <a
            href="{% url 'undo_return' Loan.id %}"
            class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-4 rounded"
          >
            ثبت بازگشت
          </a>
          {% else %}
          <button
            disabled
            class="bg-gray-400 text-white font-bold py-1 px-4 rounded cursor-not-allowed"
          >
            بازگشتی
          </button>
          {% endif %}
          
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

  {% else %}
  <p class="text-gray-600">کتابی یافت نشد.</p>
  {% endif %}
</div>
{% endblock maincontent %}
